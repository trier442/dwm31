<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>대왕중3 내신 대비 사이트</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .tab {
            cursor: pointer;
            padding: 0.75rem 1.5rem;
            color: #4B5563;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            font-weight: 500;
            white-space: nowrap;
        }
        .tab:hover {
            background-color: #e5e7eb;
            color: #111827;
        }
        .tab.active {
            color: #4338ca;
            border-bottom-color: #4338ca;
            font-weight: 700;
        }
        .question-card {
            background-color: white;
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);
        }
        .prose-box {
            background-color: #f9fafb;
            border: 1px solid #e5e7eb;
            padding: 1rem;
            margin-bottom: 1rem;
            border-radius: 0.5rem;
            font-size: 0.95em;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .option-label {
            display: block;
            padding: 0.75rem 1rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .option-label:hover {
            background-color: #f3f4f6;
        }
        input[type="radio"]:checked + .option-label {
            background-color: #e0e7ff;
            border-color: #4338ca;
            color: #4338ca;
            font-weight: 600;
        }
        input[type="radio"] {
            display: none;
        }
        .correct {
            background-color: #dcfce7 !important;
            border-color: #22c55e !important;
            color: #15803d !important;
        }
        .incorrect {
            background-color: #fee2e2 !important;
            border-color: #ef4444 !important;
            color: #991b1b !important;
        }
        #submission-status {
            display: none;
            margin-top: 1rem;
            padding: 0.75rem;
            border-radius: 0.5rem;
            text-align: center;
        }
        #submission-status.success {
            background-color: #d1fae5;
            color: #065f46;
        }
        #submission-status.error {
            background-color: #fee2e2;
            color: #991b1b;
        }
    </style>
</head>
<body class="bg-gray-100">

    <div class="container mx-auto p-4 md:p-8">
        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold text-gray-900">대왕중3 내신 대비 사이트</h1>
        </header>

        <nav class="mb-8 bg-white rounded-lg shadow-md">
            <div id="tab-container" class="flex border-b border-gray-200 overflow-x-auto">
                <!-- Tabs will be inserted here by JS -->
            </div>
        </nav>

        <main id="content-area">
            <!-- Test content will be loaded here -->
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 여기에 구글 앱 스크립트 배포 후 생성된 URL을 입력하세요.
            const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbx2Pa_asbIDPeL8BOZlLtrY2rIEU33ObPHVzqm7UmyhfgDym9i_zb0RpAWcFpyQk5Rj/exec'; 

            const examData = {
                test6: {
                    title: '실전 테스트 6',
                    questions: [
                        { work: '국어의 음운', type: '어감 차이', passage: "알록달록 가을 산에 얼룩덜룩 쓰레기\n\n10월부터 가을 산행을 준비하는 분들이 많이 계실 겁니다. 그런데 알록달록 아름다운 단풍으로 물든 산속을 들여다보면 온갖 쓰레기로 병들어 있습니다.", question: "위 글의 '알록달록'과 '얼룩덜룩'에 대한 설명으로 가장 적절한 것은?", options: ["두 단어는 자음의 차이로 느낌이 달라진다.", "'알록달록'은 어둡고 무거운 느낌을 준다.", "'얼룩덜룩'은 밝고 가벼운 느낌을 준다.", "모음의 차이가 두 단어의 느낌 차이를 유발한다.", "두 단어는 소리의 길이에 따라 의미가 달라진다."], answer: 3, explanation: "'알록달록'은 양성 모음 'ㅏ, ㅗ'가 사용되어 밝고 예쁜 느낌을 주고, '얼룩덜룩'은 음성 모음 'ㅓ, ㅜ'가 사용되어 어둡고 지저분한 느낌을 줍니다. 이처럼 모음의 차이가 단어의 느낌을 다르게 합니다." },
                        { work: '국어의 음운', type: '소리의 세기', question: "다음 중 거칠고 거센 느낌을 주는 자음(거센소리)이 포함된 단어는?", options: ["데굴데굴", "딸랑딸랑", "졸졸졸", "캄캄하게", "뒤뚱뒤뚱"], answer: 3, explanation: "거센소리는 'ㅋ, ㅌ, ㅍ, ㅊ'입니다. '캄캄하게'에는 거센소리 'ㅋ'이 포함되어 있어 거칠고 거센 느낌을 줍니다." },
                        { work: '국어의 음운', type: '음운 개수', question: "<보기>의 단어 중 음운의 개수가 4개인 것으로만 묶인 것은?", passage: "어항, 웬일, 토론, 음악, 과일", options: ["어항, 과일, 음악", "웬일, 음악, 토론", "어항, 웬일, 과일", "토론, 음악, 과일", "어항, 토론, 웬일"], answer: 0, explanation: "어항(ㅓ, ㅎ, ㅏ, ㅇ), 과일(ㄱ, ㅘ, ㅣ, ㄹ), 음악(ㅡ, ㅁ, ㅏ, ㄱ)은 모두 4개의 음운으로 이루어져 있습니다." },
                        { work: '국어의 음운', type: '소리의 길이', question: "밑줄 친 단어의 소리의 길이가 바르게 표시된 것은?", options: ["발[발:]로 발[발]을 찼다.", "밤[밤]에 밤[밤:]을 구워 먹었다.", "벨[벨:]을 받던 중 벌[벌]에 쏘였다.", "풍년이라 배[배]를 배[배:]로 수확했다.", "말[말]을 타면서 친구와 말[말:]을 했다."], answer: 4, explanation: "동물 '말[馬]'은 짧게, 언어 '말[言]'은 길게 발음합니다. 따라서 '말[말]을 타면서 친구와 말[말:]을 했다.'가 올바른 표시입니다." },
                        { work: '국어의 음운', type: '자음 체계', question: "다음 중 센입천장소리는?", options: ["ㄱ", "ㅅ", "ㅈ", "ㅎ", "ㄹ"], answer: 2, explanation: "센입천장소리는 혓바닥과 센입천장 사이에서 나는 소리로, 'ㅈ, ㅉ, ㅊ'이 해당합니다." },
                        { work: '국어의 음운', type: '음운 구분', question: "<보기>의 (가)와 (나)의 단어를 구분하는 기준으로 바르게 짝지어진 것은?", passage: "(가) 발[발] - 발[발:]\n(나) 발 - 달", options: ["(가): 소리의 길이, (나): 모음", "(가): 소리의 길이, (나): 자음", "(가): 모음, (나): 모음", "(가): 모음, (나): 자음", "(가): 자음, (나): 모음"], answer: 1, explanation: "(가)는 소리의 길이에 따라 뜻이 구별되고, (나)는 초성 자음 'ㅂ'과 'ㄷ'의 차이로 뜻이 구별됩니다." },
                        { work: '국어의 음운', type: '개념 이해', question: "음운에 관한 설명으로 적절하지 않은 것은?", options: ["국어의 분절 음운에는 자음, 모음이 포함된다.", "말의 뜻을 가진 가장 작은 소리의 단위이다.", "'중학생'이라는 단어의 음운의 개수는 7개이다.", "국어의 음운에는 자음, 모음, 소리의 길이 등이 있다.", "모음은 소리낼 때 공기의 흐름이 발음 기관의 장애를 받지 않는다."], answer: 1, explanation: "음운은 '말의 뜻을 구별해 주는' 소리의 가장 작은 단위이며, 그 자체로 뜻을 가지고 있지는 않습니다. 뜻을 가진 가장 작은 말의 단위는 '형태소'입니다." },
                        { work: '국어의 음운', type: '모음 체계', question: "모음에 관해 바르게 설명한 것은?", options: ["평순모음 중 고모음에 해당하는 모음은 'ㅡ', 'ㅓ'이다.", "원순모음 중 저모음에 해당하는 모음은 없다.", "전설모음에 해당하는 모음은 'ㅣ, ㅡ, ㅔ, ㅓ, ㅐ, ㅏ'이다.", "전설모음 중 중모음에 해당하는 모음은 'ㅔ', 'ㅟ'이다.", "후설모음 중 중모음에 해당하는 모음은 'ㅡ', 'ㅗ'이다."], answer: 1, explanation: "원순모음('ㅗ, ㅜ, ㅚ, ㅟ') 중에는 저모음이 없습니다. ① 고모음 평순은 'ㅣ, ㅡ'입니다. ③ 전설모음은 'ㅣ, ㅔ, ㅐ, ㅚ, ㅟ'입니다. ④ 전설 중모음은 'ㅔ, ㅚ'입니다. ⑤ 후설 중모음은 'ㅓ, ㅗ'입니다." },
                        { work: '국어의 음운', type: '자음 분류', passage: "눈이 내린다. 봄이라서 ①봄빛처럼 포근한 ②눈", question: "위 노랫말에 쓰인 자음을 바르게 분류한 것은?", options: ["①에 쓰인 자음은 잇몸소리이다.", "이 노랫말에 쓰인 파찰음은 없다.", "이 노랫말에 쓰인 파열음은 'ㅊ'이다.", "②에 쓰인 자음은 입술소리와 목청소리이다.", "이 노랫말에 쓰인 마찰음은 'ㅅ, ㅎ, ㅍ'이다."], answer: 0, explanation: "'봄빛처럼'에 쓰인 자음 'ㅂ, ㅊ' 중 'ㅊ'은 파찰음입니다. 하지만 '봄빛'의 받침 'ㅂ'과 '처럼'의 초성 'ㅊ'은 각각 입술소리와 센입천장소리입니다. '눈'의 'ㄴ'은 잇몸소리가 맞습니다." },
                        { work: '논증과 설득', type: '대화 분석', passage: "주희: 응. 음운은 뜻을 가진 가장 작은 말의 단위이구나.", question: "대화의 흐름상 주희의 이해가 적절하지 않은 부분은?", options: ["자음과 모음이 음운이라는 것", "소리의 길이도 음운이라는 것", "음운이 뜻을 가진 단위라는 것", "모음과 자음의 발음 방식 차이", "음운의 개념"], answer: 2, explanation: "음운은 '뜻을 구별해 주는' 소리의 단위일 뿐, 그 자체로 '뜻을 가진' 단위는 아닙니다. 뜻을 가진 가장 작은 단위는 '형태소'입니다." },
                        { work: '국어의 음운', type: '자음 체계', question: "<보기>의 설명을 모두 만족하는 자음(된소리 입술소리)이 쓰인 단어는?", passage: "• 두 입술 사이에서 나는 소리\n• 발음기관의 근육을 긴장시키거나 목소리가 나오는 통로를 좁혀 내는 소리", options: ["빙빙", "총총", "핑핑", "뺑글뺑글", "쏙닥속닥"], answer: 3, explanation: "두 입술 사이에서 나는 소리(입술소리)이면서 된소리인 것은 'ㅃ'입니다. '뺑글뺑글'에는 'ㅃ'이 사용되었습니다." },
                        { work: '국어의 음운', type: '개념 이해', question: "다음 글의 괄호 안에 들어갈 말을 순서대로 바르게 짝지은 것은?", passage: "단어의 ( ⓐ )을/를 구별해 주는 가장 작은 ( ⓑ )의 단위를 음운이라고 한다.", options: ["뜻, 소리", "모양, 소리", "소리, 뜻", "뜻, 모양", "모양, 말"], answer: 0, explanation: "음운은 단어의 '뜻'을 구별해 주는 가장 작은 '소리'의 단위입니다." },
                        { work: '국어의 음운', type: '소리의 세기', question: "'잘랑-짤랑-찰랑'에 관한 설명으로 적절하지 않은 것은?", options: ["'찰랑'에는 예사소리가 사용되지 않았다.", "'짤랑'은 '잘랑'보다 강한 느낌이다.", "'찰랑'은 '잘랑'보다 거친 느낌이다.", "세 단어는 소리의 세기에 따라 주는 느낌이 다르다.", "이러한 자음의 체계는 울림소리에서도 나타난다."], answer: 4, explanation: "예사소리-된소리-거센소리의 대립은 안울림소리에서만 나타나는 특징입니다. 울림소리는 소리의 세기에 따른 구분이 없습니다." },
                        { work: '국어의 음운', type: '자음 분석', passage: "코로나 백신", question: "<보기>의 단어를 구성하는 자음에 대한 설명으로 알맞지 않은 것은?", options: ["혀끝이 윗잇몸에 닿아서 나는 소리(잇몸소리)의 자음이 나타난다.", "공기의 흐름을 완전히 막았다가 터뜨리면서 내는 소리(파열음)의 자음이 나타난다.", "발음할 때 입 안의 통로를 막고 공기를 코로 내보내면서 나는 소리(콧소리)의 자음이 나타난다.", "발음기관의 근육을 긴장시키거나 목소리가 나오는 통로를 좁혀 소리 내는 자음(된소리)이 나타난다.", "입안이나 목청 사이의 통로를 좁혀 그 틈 사이로 공기를 내보내어 마찰을 일으키면서 내는 소리(마찰음)의 자음이 나타난다."], answer: 3, explanation: "'코로나 백신'에 사용된 자음은 'ㅋ, ㄹ, ㄴ, ㅂ, ㄲ, ㅅ, ㄴ'입니다. 이 중 된소리 'ㄲ'이 포함되어 있지 않습니다. 된소리는 'ㄲ, ㄸ, ㅃ, ㅆ, ㅉ'입니다." },
                        { work: '논증 방법', type: '유추', question: "다음 중 <보기>의 설명에 해당하는 논증 방법의 예시로 가장 적절한 것은?", passage: "귀납 논증의 하나인 이것은 둘 이상의 대상이 비슷한 성질을 가지고 있다는 것을 근거로 다른 점도 비슷할 것이라고 결론을 내리는 것이다.", options: ["모든 물고기는 헤엄을 친다. 도미는 물고기이다. 따라서 모든 도미는 헤엄을 친다.", "닭은 알을 낳는다. 꿩도 알을 낳는다. 닭과 꿩은 조류이다. 그러므로 조류는 알을 낳는다.", "구슬이 서 말이라도 꿰어야 보배인 것처럼 자신이 가진 능력도 잘 활용해야 값진 것이 된다.", "인터넷상의 언어 예절 문제가 심각하다. 사용자의 인식 개선과 더불어 사회적인 예절 교육이 필요하다.", "국민에게는 나라를 지킬 의무가 있다. 너는 우리나라 국민이다. 따라서 너에게도 나라를 지킬 의무가 있다."], answer: 2, explanation: "보기는 유추에 대한 설명입니다. ③은 '구슬'과 '자신의 능력'의 유사점을 바탕으로 결론을 이끌어내는 유추 논증입니다." },
                        { work: '논증 방법', type: '논증 방법 구분', question: "<보기> 광고와 동일한 논증 방법이 쓰인 글은?", passage: "광고 문구: 예약은 약속입니다. / 예약 취소 전화해 주세요!", options: ["(나) 생명을 불어넣는 마법사의 물", "(다) 감정은 언제나 옳다", "(라) 층간 소음 안내문", "모두 해당 없음"], answer: 2, explanation: "보기 광고는 '약속을 못 지키면 알려야 한다(대전제)' -> '예약은 약속이다(소전제)' -> '예약 취소 시 알려달라(결론)'의 연역 논증입니다. (라) 층간 소음 안내문 역시 '사람 사이의 문제는 소통으로 해결된다(대전제)'를 바탕으로 결론을 이끌어내는 연역 논증을 사용했습니다." },
                        { work: '논증 방법', type: '개념 이해', question: "논증에 대한 설명으로 적절한 것을 <보기>에서 모두 고른 것은?", passage: "ㄱ. 구체적 사례가 충분할수록 귀납 논증의 개연성이 높아진다.\nㄴ. 유추는 연역 논증에 속한다.\nㄷ. 연역 논증은 새로운 사실을 밝혀내기보다 개별적 사실을 증명하는 데 주로 사용된다.\nㄹ. 귀납 논증은 결론이 언제나 참이다.", options: ["ㄱ, ㄴ", "ㄱ, ㄷ", "ㄴ, ㄷ, ㄹ", "ㄱ, ㄷ, ㄹ, ㅁ"], answer: 1, explanation: "ㄱ과 ㄷ이 옳은 설명입니다. ㄴ: 유추는 귀납 논증에 속합니다. ㄹ: 귀납 논증의 결론은 개연적일 뿐, 항상 참인 것은 아닙니다." },
                        { work: '논증 방법', type: '내용 일치', passage: "글 <생명을 불어넣는 마법사의 물>", question: "위 글의 내용과 일치하는 것은?", options: ["멸균한 육즙은 변형되어 생명체인 미생물이 발생한다.", "과학자들의 말은 무조건 밑도 끝도 없이 의심해야 한다.", "영국왕립학회의 모토는 이 기관의 말이 항상 옳기 때문에 인용되었다.", "아리스토텔레스 시대 사람들의 대부분은 그의 주장을 별 의심 없이 받아들였다.", "자유 낙하를 하는 두 물체 중 더 무거운 것이 더 빨리 땅에 떨어지는 것은 불변의 법칙이다."], answer: 3, explanation: "본문에 '대부분의 사람은 이 주장을 별 의심 없이 받아들였습니다.'라고 명시되어 있습니다." },
                        { work: '논증 방법', type: '귀납', question: "글 (나) <생명을 불어넣는 마법사의 물>에 사용된 논증 방법에 대한 설명으로 가장 적절한 것은?", options: ["결론의 내용이 근거에 이미 포함되어 있다.", "일반적 원리로부터 구체적 사실을 이끌어 내고 있다.", "대전제-소전제-결론의 삼단 논법을 사용하고 있다.", "개별적 사례로부터 보편적 사실을 이끌어 내고 있다.", "비슷한 성질을 가진 둘 이상의 대상을 예로 들어 구체적 사실을 증명하고 있다."], answer: 3, explanation: "글 (나)는 파스퇴르, 갈릴레이, 코페르니쿠스라는 개별적이고 구체적인 사례를 통해 '탐구란 무엇인가'라는 보편적 사실(결론)을 이끌어 내는 귀납 논증을 사용하고 있습니다." },
                        { work: '논증 방법', type: '유추', passage: "글 (다) <감정은 언제나 옳다>", question: "위 글의 논증 방법에 대한 설명으로 가장 적절한 것은?", options: ["특수한 사례로부터 구체적 사실을 이끌어 내고 있다.", "일반적 원리로부터 개별적 사실을 이끌어 내고 있다.", "특정 상태나 행동에 대하여 명제로 이야기하고 있다.", "어떤 대상이나 사물, 현상 등을 언어로 서술하고 있다.", "둘 이상의 대상이 비슷한 속성을 가진다는 것을 근거로 다른 속성도 유사할 것이라고 추론하고 있다."], answer: 4, explanation: "글 (다)는 '인생'과 '버스 운전'이라는 두 대상의 비슷한 속성을 근거로 결론을 이끌어 내는 유추 논증을 사용하고 있습니다." },
                        { work: '논증 방법', type: '연역', passage: "글 (라) 층간 소음 안내문", question: "위 글을 삼단논법으로 정리할 때, 소전제에 해당하는 내용은?", options: ["층간 소음 문제도 사람들 사이의 문제이다.", "소통하지 않으면 상대방의 처지를 알 수 없다.", "적극적으로 소통을 하면 이웃 간에 정이 넘친다.", "상대방과 대화를 나누면 서로의 상황을 이해할 수 있다.", "역지사지의 마음을 가지면 층간 소음 문제는 해결된다."], answer: 0, explanation: "이 글은 '사람들 사이의 문제는 소통으로 해결된다(대전제)'와 '층간 소음 문제도 사람들 사이의 문제이다(소전제)'를 근거로 '따라서 층간 소음 문제는 소통으로 해결할 수 있다(결론)'는 연역 논증 구조를 가집니다." },
                        { work: '논증 방법', type: '비유적 표현', passage: "의심은 마법사의 물과 같습니다.", question: "글 (나)에서 위와 같이 비유한 이유로 가장 적절한 것은?", options: ["사람들은 마법에 대한 막연한 환상을 갖고 있기 때문에", "마법사의 물만 생명을 살릴 수 있는 능력이 있기 때문에", "의심하는 것은 어린아이의 순수성이 필요하기 때문이다.", "당연한 상식이 우리 생각을 지배하는 것은 올바른 일이기 때문이다.", "의심이 죽어 있던 진실에 생명을 불어넣을 수 있기 때문이다."], answer: 4, explanation: "글에서 '의심하는 순간 죽어 있던 진실이 생명을 얻고 살아나기 시작하니까요.'라고 설명하고 있듯이, 의심이 진실을 밝히는 계기가 된다는 점을 강조하기 위해 비유적 표현을 사용했습니다." },
                        { work: '설득 전략', type: '전략 분석', question: "강연자가 강연을 준비하며 고려했을 사항으로 가장 적절하지 않은 것은?", options: ["내가 겪은 경험을 바탕으로 주장을 뒷받침해야겠다.", "분명하고 당당한 말투로 이야기해야 신뢰감을 줄 수 있겠지?", "유명한 사람의 의견을 인용해서 주장을 강조하면 더 논리적일 거야.", "시각 자료를 사용해 '만다꼬'의 의미를 재미있게 전달해야겠다.", "강연의 핵심을 질문하고 청중이 답하게 해서 주장에 공감하게 해야겠다."], answer: 2, explanation: "강연자는 자신의 경험, 사투리, 청중과의 소통 등 다양한 전략을 사용했지만, 유명인의 말을 직접 인용하여 주장을 강조하는 전략은 사용하지 않았습니다." },
                        { work: '설득 전략', type: '전략 구분', question: "다음 <보기>에 사용된 논증 방법과 설득 전략이 바르게 짝지어진 것은?", passage: "지금 내 앞에 존재하는 것과 싸우는 것만큼 비생산적인 것이 없습니다... 나는 내 인생 버스를 운전하는 기사입니다...", options: ["귀납 - 이성적 설득", "연역 - 감성적 설득", "유추 - 이성적 설득", "귀납 - 인성적 설득", "유추 - 감성적 설득"], answer: 2, explanation: "인생을 버스 운전에 비유하는 '유추'라는 논증 방법을 사용하여, '다른 사람과 싸우지 말고 있는 그대로 받아들이자'는 주장을 논리적으로 뒷받침하고 있으므로 유추, 이성적 설득에 해당합니다." },
                        { work: '설득 전략', type: '종합 분석', question: "강연 '힘들 때 힘을 빼면 힘이 생긴다'에 사용된 설득 전략으로 적절하지 않은 것은?", options: ["듣는 이와 공통의 관심사(야구)를 말하며 거리감을 좁혔다.", "사투리를 실감 나게 구사하여 재미와 웃음을 주었다.", "자신의 직업적 전문성을 바탕으로 욕망을 성찰할 것을 이야기했다.", "권위 있는 기관의 통계 자료를 제시하여 주장의 객관성을 높였다.", "자신의 건강한 인생관을 솔직하게 말하여 신뢰를 주었다."], answer: 3, explanation: "이 강연에서는 강연자의 경험, 유머, 전문성, 진솔한 태도 등 다양한 설득 전략이 사용되었지만, 객관적인 통계 자료를 제시하는 부분은 없었습니다." }
                    ]
                }
            };
        
            const tabContainer = document.getElementById('tab-container');
            const contentArea = document.getElementById('content-area');

            function renderTest(testId, test) {
                let questionsHtml = '';
                test.questions.forEach((q, index) => {
                    const optionsHtml = q.options.map((opt, i) => `
                        <div class="mt-2">
                            <input type="radio" name="question${index}" id="q${index}o${i}" value="${i}">
                            <label for="q${index}o${i}" class="option-label">
                                <span class="font-mono mr-2">${i + 1}</span> ${opt}
                            </label>
                        </div>
                    `).join('');
                    questionsHtml += `
                        <div class="question-card" data-work="${q.work}" data-type="${q.type}" data-answer="${q.answer}">
                            <div class="mb-4">
                                <span class="inline-block bg-indigo-100 text-indigo-800 text-xs font-semibold mr-2 px-2.5 py-0.5 rounded-full">${q.work}</span>
                                <span class="inline-block bg-gray-100 text-gray-800 text-xs font-semibold mr-2 px-2.5 py-0.5 rounded-full">${q.type}</span>
                            </div>
                            <h3 class="font-semibold text-lg mb-2 text-gray-800">${index + 1}. ${q.question}</h3>
                            ${q.passage ? `<div class="prose-box">${q.passage}</div>` : ''}
                            <div class="space-y-2">${optionsHtml}</div>
                        </div>
                    `;
                });
                
                contentArea.innerHTML = `
                    <div id="test-container">
                        <div class="bg-white p-6 rounded-lg shadow-md mb-8">
                            <label for="student-name" class="block text-lg font-semibold text-gray-700 mb-2">이름을 입력하세요:</label>
                            <input type="text" id="student-name" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="이름">
                        </div>
                        ${questionsHtml}
                        <div class="text-center mt-8">
                            <button id="submit-btn" class="bg-indigo-600 text-white font-bold py-3 px-8 rounded-lg text-lg hover:bg-indigo-700 transition duration-300">제출하기</button>
                        </div>
                    </div>
                    <div id="result-container" class="hidden"></div>
                `;
                
                document.getElementById('submit-btn').addEventListener('click', () => handleSubmit(testId));
            }

            function renderResults(name, score, correctCount, questions, userAnswers, weakestWork, weakestType) {
                let detailedResultsHtml = '<h3 class="text-2xl font-bold text-gray-800 mb-6 border-b pb-3">상세 해설</h3>';
                questions.forEach((q, index) => {
                    const userAnswer = userAnswers[index];
                    const isCorrect = userAnswer === q.answer;
                    
                    const optionsHtml = q.options.map((opt, i) => {
                        let labelClass = "option-label";
                        if(i === q.answer) {
                            labelClass += " correct";
                        } else if (i === userAnswer && !isCorrect) {
                            labelClass += " incorrect";
                        }
                        
                        return `<div class="mt-2"><div class="${labelClass}"><span class="font-mono mr-2">${i + 1}</span> ${opt}</div></div>`;
                    }).join('');

                    detailedResultsHtml += `
                        <div class="question-card">
                             <div class="mb-4">
                                <span class="inline-block bg-indigo-100 text-indigo-800 text-xs font-semibold mr-2 px-2.5 py-0.5 rounded-full">${q.work}</span>
                                <span class="inline-block bg-gray-100 text-gray-800 text-xs font-semibold mr-2 px-2.5 py-0.5 rounded-full">${q.type}</span>
                            </div>
                            <h4 class="font-semibold text-lg mb-2">${isCorrect ? '<span class="text-green-600 font-bold">[정답]</span>' : '<span class="text-red-600 font-bold">[오답]</span>'} ${index + 1}. ${q.question}</h4>
                            ${q.passage ? `<div class="prose-box">${q.passage}</div>` : ''}
                            <div class="space-y-2">${optionsHtml}</div>
                            <div class="mt-4 p-4 bg-gray-50 rounded-md">
                                <p class="font-semibold text-gray-700">해설</p>
                                <p class="text-gray-600 text-sm mt-1">${q.explanation}</p>
                            </div>
                        </div>
                    `;
                });
                
                const resultContainer = document.getElementById('result-container');
                resultContainer.innerHTML = `
                    <div class="question-card text-center">
                        <h2 class="text-3xl font-bold text-gray-800 mb-2">시험 결과: ${name} 학생</h2>
                        <p class="text-6xl font-bold text-indigo-600 my-6">${score}<span class="text-3xl text-gray-500">점</span></p>
                        <p class="text-lg text-gray-700">${questions.length}문제 중 ${correctCount}문제 정답</p>
                        <div id="submission-status"></div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-8">
                         <div class="question-card">
                            <h3 class="text-xl font-bold text-gray-800 mb-4">취약점 분석</h3>
                            <div class="space-y-3">
                                <p class="text-gray-700"><strong>가장 많이 틀린 영역:</strong> <span class="font-semibold text-red-600">${weakestWork}</span></p>
                                <p class="text-gray-700"><strong>가장 많이 틀린 유형:</strong> <span class="font-semibold text-red-600">${weakestType}</span></p>
                            </div>
                         </div>
                         <div class="question-card">
                            <h3 class="text-xl font-bold text-gray-800 mb-4">학습 가이드</h3>
                            <p class="text-gray-700">'${weakestWork}' 영역의 기본 개념을 다시 한번 꼼꼼히 복습하고, '${weakestType}' 유형의 문제 풀이 전략을 보충하는 것이 좋겠습니다. 오답 노트를 작성하여 틀린 문제를 완벽하게 이해하는 것이 중요합니다.</p>
                         </div>
                    </div>

                    <div class="mt-12">${detailedResultsHtml}</div>
                `;
                resultContainer.classList.remove('hidden');
            }

            async function sendDataToGoogleSheet(data) {
                const statusDiv = document.getElementById('submission-status');
                if (!SCRIPT_URL) {
                    console.error("Google Apps Script URL이 설정되지 않았습니다.");
                    if(statusDiv) {
                        statusDiv.textContent = '결과 전송 URL이 설정되지 않았습니다. 관리자에게 문의하세요.';
                        statusDiv.className = 'error';
                        statusDiv.style.display = 'block';
                    }
                    return;
                }

                try {
                    await fetch(SCRIPT_URL, {
                        method: 'POST',
                        mode: 'no-cors', // CORS 에러 방지를 위해 추가
                        body: JSON.stringify(data),
                        headers: {
                            'Content-Type': 'application/json',
                        },
                    });
                    
                    if(statusDiv) {
                        statusDiv.textContent = '성공적으로 제출되었습니다!';
                        statusDiv.className = 'success';
                        statusDiv.style.display = 'block';
                    }
                } catch (error) {
                     if(statusDiv) {
                        statusDiv.textContent = '제출 중 오류가 발생했습니다. 다시 시도해주세요.';
                        statusDiv.className = 'error';
                        statusDiv.style.display = 'block';
                    }
                    console.error('Error:', error);
                }
            }
            
            function handleSubmit(testId) {
                const studentName = document.getElementById('student-name').value.trim();
                if (!studentName) {
                    const nameInput = document.getElementById('student-name');
                    nameInput.classList.add('border-red-500', 'focus:ring-red-500');
                    nameInput.placeholder = "이름을 먼저 입력해주세요!";
                    nameInput.focus();
                    return;
                }

                const questions = examData[testId].questions;
                const questionElements = document.querySelectorAll('.question-card');
                let correctCount = 0;
                const userAnswers = [];
                const analysis = { byWork: {}, byType: {} };

                questionElements.forEach((qEl, index) => {
                    const selected = qEl.querySelector(`input[name="question${index}"]:checked`);
                    const userAnswer = selected ? parseInt(selected.value) : -1;
                    userAnswers.push(userAnswer);
                    
                    const correctAnswer = parseInt(qEl.dataset.answer);
                    const work = qEl.dataset.work;
                    const type = qEl.dataset.type;

                    if (userAnswer === correctAnswer) {
                        correctCount++;
                    } else {
                        analysis.byWork[work] = (analysis.byWork[work] || 0) + 1;
                        analysis.byType[type] = (analysis.byType[type] || 0) + 1;
                    }
                });

                const score = Math.round((correctCount / questions.length) * 100);
                
                const findWeakest = (data) => {
                    let weakest = '없음';
                    let maxErrors = 0;
                    for (const key in data) {
                        if (data[key] > maxErrors) {
                            maxErrors = data[key];
                            weakest = key;
                        }
                    }
                    return weakest;
                };

                const weakestWork = findWeakest(analysis.byWork);
                const weakestType = findWeakest(analysis.byType);

                const resultData = {
                    timestamp: new Date().toLocaleString("ko-KR"),
                    studentName: studentName,
                    testTitle: examData[testId].title,
                    score: score,
                    correctCount: correctCount,
                    totalQuestions: questions.length,
                    weakestWork: weakestWork,
                    weakestType: weakestType,
                };
                
                sendDataToGoogleSheet(resultData);

                document.getElementById('test-container').classList.add('hidden');
                renderResults(studentName, score, correctCount, questions, userAnswers, weakestWork, weakestType);
            }

            function switchTab(testId) {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                const currentTab = document.querySelector(`.tab[data-id="${testId}"]`);
                if(currentTab) currentTab.classList.add('active');

                contentArea.innerHTML = '';
                const test = examData[testId];

                if (test.questions && test.questions.length > 0) {
                    renderTest(testId, test);
                } else {
                    contentArea.innerHTML = `
                        <div class="question-card text-center py-20">
                            <h2 class="text-3xl font-bold text-gray-800 mb-4">${test.title}</h2>
                            <p class="text-gray-600 text-lg">시험지가 준비 중입니다.</p>
                        </div>
                    `;
                }
            }
            
            // --- Initialization ---
            const tests = Object.keys(examData);
            tests.forEach((testId) => {
                const tab = document.createElement('a');
                tab.className = 'tab';
                tab.textContent = examData[testId].title;
                tab.dataset.id = testId;
                tab.addEventListener('click', () => switchTab(testId));
                tabContainer.appendChild(tab);
            });
            
            // 초기 로드 시 첫 번째 탭 활성화
            if (tests.length > 0) {
                switchTab(tests[0]);
            }
        });
    </script>
</body>
</html>
